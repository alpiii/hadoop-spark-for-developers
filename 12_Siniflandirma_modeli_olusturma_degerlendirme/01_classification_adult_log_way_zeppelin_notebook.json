{"paragraphs":[{"text":"%pyspark\n# Hive tablosunu okuyup dataframe oluşturma\ndf = spark.sql(\"select * from adult_preprocessed\")","user":"anonymous","dateUpdated":"2019-04-26T08:22:25+0000","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1556265671154_1509369044","id":"20190425-200014_892861738","dateCreated":"2019-04-26T08:01:11+0000","dateStarted":"2019-04-26T08:06:38+0000","dateFinished":"2019-04-26T08:07:42+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:30617"},{"text":"%pyspark\nz.show(df.limit(20))","user":"anonymous","dateUpdated":"2019-04-26T08:18:28+0000","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python"}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"workclass\teducation\teducation_merged\tmarital_status\toccupation\trelationship\trace\tsex\tnative_country\tage\tfnlwgt\teducation_num\tcapital_gain\tcapital_loss\thours_per_week\toutput\nState-gov\tBachelors\tUnder-Graduate\tNever-married\tAdm-clerical\tNot-in-family\tWhite\tMale\tUnited-States\t39\t77516.0\t13.0\t2174.0\t0.0\t40.0\t<=50K\nSelf-emp-not-inc\tBachelors\tUnder-Graduate\tMarried-civ-spouse\tExec-managerial\tHusband\tWhite\tMale\tUnited-States\t50\t83311.0\t13.0\t0.0\t0.0\t13.0\t<=50K\nPrivate\tHS-grad\tHS-grad\tDivorced\tHandlers-cleaners\tNot-in-family\tWhite\tMale\tUnited-States\t38\t215646.0\t9.0\t0.0\t0.0\t40.0\t<=50K\nPrivate\t11th\tHigh-School\tMarried-civ-spouse\tHandlers-cleaners\tHusband\tBlack\tMale\tUnited-States\t53\t234721.0\t7.0\t0.0\t0.0\t40.0\t<=50K\nPrivate\tBachelors\tUnder-Graduate\tMarried-civ-spouse\tProf-specialty\tWife\tBlack\tFemale\tCuba\t28\t338409.0\t13.0\t0.0\t0.0\t40.0\t<=50K\nPrivate\tMasters\tPost-Graduate\tMarried-civ-spouse\tExec-managerial\tWife\tWhite\tFemale\tUnited-States\t37\t284582.0\t14.0\t0.0\t0.0\t40.0\t<=50K\nPrivate\t9th\tHigh-School\tMarried-spouse-absent\tOther-service\tNot-in-family\tBlack\tFemale\tJamaica\t49\t160187.0\t5.0\t0.0\t0.0\t16.0\t<=50K\nSelf-emp-not-inc\tHS-grad\tHS-grad\tMarried-civ-spouse\tExec-managerial\tHusband\tWhite\tMale\tUnited-States\t52\t209642.0\t9.0\t0.0\t0.0\t45.0\t>50K\nPrivate\tMasters\tPost-Graduate\tNever-married\tProf-specialty\tNot-in-family\tWhite\tFemale\tUnited-States\t31\t45781.0\t14.0\t14084.0\t0.0\t50.0\t>50K\nPrivate\tBachelors\tUnder-Graduate\tMarried-civ-spouse\tExec-managerial\tHusband\tWhite\tMale\tUnited-States\t42\t159449.0\t13.0\t5178.0\t0.0\t40.0\t>50K\nPrivate\tSome-college\tUnder-Graduate\tMarried-civ-spouse\tExec-managerial\tHusband\tBlack\tMale\tUnited-States\t37\t280464.0\t10.0\t0.0\t0.0\t80.0\t>50K\nState-gov\tBachelors\tUnder-Graduate\tMarried-civ-spouse\tProf-specialty\tHusband\tAsian-Pac-Islander\tMale\tIndia\t30\t141297.0\t13.0\t0.0\t0.0\t40.0\t>50K\nPrivate\tBachelors\tUnder-Graduate\tNever-married\tAdm-clerical\tOwn-child\tWhite\tFemale\tUnited-States\t23\t122272.0\t13.0\t0.0\t0.0\t30.0\t<=50K\nPrivate\tAssoc-acdm\tAssoc-acdm\tNever-married\tSales\tNot-in-family\tBlack\tMale\tUnited-States\t32\t205019.0\t12.0\t0.0\t0.0\t50.0\t<=50K\nPrivate\t7th-8th\tElementary-School\tMarried-civ-spouse\tTransport-moving\tHusband\tAmer-Indian-Eskimo\tMale\tMexico\t34\t245487.0\t4.0\t0.0\t0.0\t45.0\t<=50K\nSelf-emp-not-inc\tHS-grad\tHS-grad\tNever-married\tFarming-fishing\tOwn-child\tWhite\tMale\tUnited-States\t25\t176756.0\t9.0\t0.0\t0.0\t35.0\t<=50K\nPrivate\tHS-grad\tHS-grad\tNever-married\tMachine-op-inspct\tUnmarried\tWhite\tMale\tUnited-States\t32\t186824.0\t9.0\t0.0\t0.0\t40.0\t<=50K\nPrivate\t11th\tHigh-School\tMarried-civ-spouse\tSales\tHusband\tWhite\tMale\tUnited-States\t38\t28887.0\t7.0\t0.0\t0.0\t50.0\t<=50K\nSelf-emp-not-inc\tMasters\tPost-Graduate\tDivorced\tExec-managerial\tUnmarried\tWhite\tFemale\tUnited-States\t43\t292175.0\t14.0\t0.0\t0.0\t45.0\t>50K\nPrivate\tDoctorate\tPost-Graduate\tMarried-civ-spouse\tProf-specialty\tHusband\tWhite\tMale\tUnited-States\t40\t193524.0\t16.0\t0.0\t0.0\t60.0\t>50K\n"}]},"apps":[],"jobName":"paragraph_1556265671160_1505521555","id":"20190425-200201_1475409006","dateCreated":"2019-04-26T08:01:11+0000","dateStarted":"2019-04-26T08:18:28+0000","dateFinished":"2019-04-26T08:18:28+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:30618"},{"text":"%pyspark\nz.show(df.describe())","user":"anonymous","dateUpdated":"2019-04-26T08:09:49+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"summary\tworkclass\teducation\teducation_merged\tmarital_status\toccupation\trelationship\trace\tsex\tnative_country\tage\tfnlwgt\teducation_num\tcapital_gain\tcapital_loss\thours_per_week\toutput\ncount\t45207\t45207\t45207\t45207\t45207\t45207\t45207\t45207\t45207\t45207\t45207\t45207\t45207\t45207\t45207\t45207\nmean\tnull\tnull\tnull\tnull\tnull\tnull\tnull\tnull\tnull\t38.55018028181476\t189729.29716636805\t10.11830026323357\t1101.6343707832857\t88.53429778574115\t40.93779724378968\tnull\nstddev\tnull\tnull\tnull\tnull\tnull\tnull\tnull\tnull\tnull\t13.218450124938885\t105645.82277986674\t2.552988114347374\t7507.593758512776\t404.8097839880829\t12.00791584930777\tnull\nmin\tFederal-gov\t10th\tAssoc-acdm\tDivorced\tAdm-clerical\tHusband\tAmer-Indian-Eskimo\tFemale\tCambodia\t17\t13492.0\t1.0\t0.0\t0.0\t1.0\t<=50K\nmax\tWithout-pay\tSome-college\tUnder-Graduate\tWidowed\tTransport-moving\tWife\tWhite\tMale\tYugoslavia\t90\t1490400.0\t16.0\t99999.0\t4356.0\t99.0\t>50K\n"}]},"apps":[],"jobName":"paragraph_1556265671161_1505136806","id":"20190425-200621_1610568337","dateCreated":"2019-04-26T08:01:11+0000","dateStarted":"2019-04-26T08:09:49+0000","dateFinished":"2019-04-26T08:09:54+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:30619"},{"text":"%pyspark\n# hedef değişken output dağılımı, sınıf dengesi\nimport pyspark.sql.functions as f\ndf.groupBy(\"output\").agg(f.count(\"*\").alias(\"sayi\")).show()","user":"anonymous","dateUpdated":"2019-04-26T08:28:15+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+------+-----+\n|output| sayi|\n+------+-----+\n| <=50K|34003|\n|  >50K|11204|\n+------+-----+\n\n"}]},"apps":[],"jobName":"paragraph_1556266163865_142458014","id":"20190426-080923_2091944499","dateCreated":"2019-04-26T08:09:23+0000","dateStarted":"2019-04-26T08:25:59+0000","dateFinished":"2019-04-26T08:26:04+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:30620"},{"text":"%pyspark\n# education dağılımı\ndf.groupBy(\"education\").agg(\nf.count(\"*\").alias(\"sayi\"), \nf.mean(\"hours_per_week\").alias(\"ortalama_calima_saati\")\n).sort(f.desc(\"sayi\")) \\\n.show()","user":"anonymous","dateUpdated":"2019-04-26T08:32:52+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+------------+-----+---------------------+\n|   education| sayi|ortalama_calima_saati|\n+------------+-----+---------------------+\n|     HS-grad|14778|    41.10211124644742|\n|Some-college| 9894|    39.47321609055994|\n|   Bachelors| 7569|   42.832342449464925|\n|     Masters| 2512|     43.9781050955414|\n|   Assoc-voc| 1959|    42.00816743236345|\n|        11th| 1619|    34.34651019147622|\n|  Assoc-acdm| 1507|    41.52289316522893|\n|        10th| 1223|    37.50695012264922|\n|     7th-8th|  823|    39.81166464155528|\n| Prof-school|  784|   47.923469387755105|\n|         9th|  676|    38.99556213017752|\n|        12th|  576|    35.57465277777778|\n|   Doctorate|  544|    47.29044117647059|\n|     5th-6th|  449|    38.83964365256125|\n|     1st-4th|  222|    39.18468468468468|\n|   Preschool|   72|   36.791666666666664|\n+------------+-----+---------------------+\n\n"}]},"apps":[],"jobName":"paragraph_1556267159437_-1931142109","id":"20190426-082559_2087232512","dateCreated":"2019-04-26T08:25:59+0000","dateStarted":"2019-04-26T08:32:53+0000","dateFinished":"2019-04-26T08:32:54+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:30621"},{"text":"%pyspark\ndf.columns","user":"anonymous","dateUpdated":"2019-04-26T08:36:11+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"['workclass', 'education', 'education_merged', 'marital_status', 'occupation', 'relationship', 'race', 'sex', 'native_country', 'age', 'fnlwgt', 'education_num', 'capital_gain', 'capital_loss', 'hours_per_week', 'output']\n"}]},"apps":[],"jobName":"paragraph_1556267764602_261046566","id":"20190426-083604_1527464856","dateCreated":"2019-04-26T08:36:04+0000","dateStarted":"2019-04-26T08:36:11+0000","dateFinished":"2019-04-26T08:36:11+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:30622"},{"text":"%pyspark\nkategorik = ['workclass', 'education', 'education_merged', 'marital_status', 'occupation', 'relationship', 'race', 'sex', 'native_country']\nnumerik = ['age', 'fnlwgt', 'education_num', 'capital_gain', 'capital_loss', 'hours_per_week']\nlabel = [\"output\"]","user":"anonymous","dateUpdated":"2019-04-26T08:37:15+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1556267427911_1854015926","id":"20190426-083027_606068187","dateCreated":"2019-04-26T08:30:27+0000","dateStarted":"2019-04-26T08:37:15+0000","dateFinished":"2019-04-26T08:37:15+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:30623"},{"text":"%md\n## StringIndexer Aşaması","user":"anonymous","dateUpdated":"2019-04-26T08:58:09+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h2>StringIndexer Aşaması</h2>\n"}]},"apps":[],"jobName":"paragraph_1556269074018_908660519","id":"20190426-085754_1514608529","dateCreated":"2019-04-26T08:57:54+0000","dateStarted":"2019-04-26T08:58:09+0000","dateFinished":"2019-04-26T08:58:10+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:30624"},{"text":"%pyspark\nfrom pyspark.ml.feature import StringIndexer","user":"anonymous","dateUpdated":"2019-04-26T08:38:34+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1556267835011_872320623","id":"20190426-083715_222086173","dateCreated":"2019-04-26T08:37:15+0000","dateStarted":"2019-04-26T08:38:34+0000","dateFinished":"2019-04-26T08:38:35+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:30625"},{"text":"%pyspark\nworkclass_indexer = StringIndexer(inputCol=\"workclass\", outputCol=\"workclass_indexed\", handleInvalid=\"skip\")\neducation_indexer = StringIndexer(inputCol=\"education\", outputCol=\"education_indexed\", handleInvalid=\"skip\")\nmarital_status_indexer = StringIndexer(inputCol=\"marital_status\", outputCol=\"marital_status_indexed\", handleInvalid=\"skip\")\noccupation_indexer = StringIndexer(inputCol=\"occupation\", outputCol=\"occupation_indexed\", handleInvalid=\"skip\")\nrace_indexer = StringIndexer(inputCol=\"race\", outputCol=\"race_indexed\", handleInvalid=\"skip\")\nrelationship_indexer = StringIndexer(inputCol=\"relationship\", outputCol=\"relationship_indexed\", handleInvalid=\"skip\")\nsex_indexer = StringIndexer(inputCol=\"sex\", outputCol=\"sex_indexed\", handleInvalid=\"skip\")\nnative_country_indexer = StringIndexer(inputCol=\"native_country\", outputCol=\"native_country_indexed\", handleInvalid=\"skip\")","user":"anonymous","dateUpdated":"2019-04-26T09:06:34+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1556267914304_1938398528","id":"20190426-083834_1919743628","dateCreated":"2019-04-26T08:38:34+0000","dateStarted":"2019-04-26T08:43:46+0000","dateFinished":"2019-04-26T08:43:46+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:30626"},{"text":"%pyspark\n# 'workclass', 'education', 'education_merged', 'marital_status', 'occupation', 'relationship', 'race', 'sex', 'native_country'\nworkclass_df = workclass_indexer.fit(df).transform(df)\neducation_df = education_indexer.fit(workclass_df).transform(workclass_df)\nmarital_status_df = marital_status_indexer.fit(education_df).transform(education_df)\noccupation_df = occupation_indexer.fit(marital_status_df).transform(marital_status_df)\nrelationship_df = relationship_indexer.fit(occupation_df).transform(occupation_df)\nrace_df = race_indexer.fit(relationship_df).transform(relationship_df)\nsex_df = sex_indexer.fit(race_df).transform(race_df)\nstringIndexed_df = native_country_indexer.fit(sex_df).transform(sex_df)\n\nz.show(stringIndexed_df.limit(3))","user":"anonymous","dateUpdated":"2019-04-26T08:54:42+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"workclass\teducation\teducation_merged\tmarital_status\toccupation\trelationship\trace\tsex\tnative_country\tage\tfnlwgt\teducation_num\tcapital_gain\tcapital_loss\thours_per_week\toutput\tworkclass_indexed\teducation_indexed\tmarital_status_indexed\toccupation_indexed\trelationship_indexed\trace_indexed\tsex_indexed\tnative_country_indexed\nState-gov\tBachelors\tUnder-Graduate\tNever-married\tAdm-clerical\tNot-in-family\tWhite\tMale\tUnited-States\t39\t77516.0\t13.0\t2174.0\t0.0\t40.0\t<=50K\t3.0\t2.0\t1.0\t3.0\t1.0\t0.0\t0.0\t0.0\nSelf-emp-not-inc\tBachelors\tUnder-Graduate\tMarried-civ-spouse\tExec-managerial\tHusband\tWhite\tMale\tUnited-States\t50\t83311.0\t13.0\t0.0\t0.0\t13.0\t<=50K\t1.0\t2.0\t0.0\t2.0\t0.0\t0.0\t0.0\t0.0\nPrivate\tHS-grad\tHS-grad\tDivorced\tHandlers-cleaners\tNot-in-family\tWhite\tMale\tUnited-States\t38\t215646.0\t9.0\t0.0\t0.0\t40.0\t<=50K\t0.0\t0.0\t2.0\t8.0\t1.0\t0.0\t0.0\t0.0\n"}]},"apps":[],"jobName":"paragraph_1556268044371_1373353991","id":"20190426-084044_1072147200","dateCreated":"2019-04-26T08:40:44+0000","dateStarted":"2019-04-26T08:54:43+0000","dateFinished":"2019-04-26T08:54:45+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:30627"},{"text":"%md\n## OneHotEncoder Aşaması","user":"anonymous","dateUpdated":"2019-04-26T08:59:11+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h2>OneHotEncoder Aşaması</h2>\n"}]},"apps":[],"jobName":"paragraph_1556268367904_890967003","id":"20190426-084607_466447386","dateCreated":"2019-04-26T08:46:07+0000","dateStarted":"2019-04-26T08:59:11+0000","dateFinished":"2019-04-26T08:59:11+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:30628"},{"text":"%pyspark\nfrom pyspark.ml.feature import OneHotEncoder","user":"anonymous","dateUpdated":"2019-04-26T08:59:41+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1556269099522_1261890658","id":"20190426-085819_156578033","dateCreated":"2019-04-26T08:58:19+0000","dateStarted":"2019-04-26T08:59:41+0000","dateFinished":"2019-04-26T08:59:41+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:30629"},{"text":"%pyspark\n# 'workclass', 'education', 'education_merged', 'marital_status', 'occupation', 'relationship', 'race', 'sex', 'native_country'\nworkclass_encoder = OneHotEncoder(inputCol=\"workclass_indexed\", outputCol=\"workclass_onehot\")\neducation_encoder = OneHotEncoder(inputCol=\"education_indexed\", outputCol=\"education_onehot\")\nmarital_status_encoder = OneHotEncoder(inputCol=\"marital_status_indexed\", outputCol=\"marital_status_onehot\")\noccupation_encoder = OneHotEncoder(inputCol=\"occupation_indexed\", outputCol=\"occupation_onehot\")\nrelationship_encoder = OneHotEncoder(inputCol=\"relationship_indexed\", outputCol=\"relationship_onehot\")\nrace_encoder = OneHotEncoder(inputCol=\"race_indexed\", outputCol=\"race_onehot\")\nsex_encoder = OneHotEncoder(inputCol=\"sex_indexed\", outputCol=\"sex_onehot\")\nnative_country_encoder = OneHotEncoder(inputCol=\"native_country_indexed\", outputCol=\"native_country_onehot\")","user":"anonymous","dateUpdated":"2019-04-26T09:05:34+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1556269174414_390943386","id":"20190426-085934_1165529111","dateCreated":"2019-04-26T08:59:34+0000","dateStarted":"2019-04-26T09:05:34+0000","dateFinished":"2019-04-26T09:05:34+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:30630"},{"text":"%pyspark\nworkclass_onehot_df = workclass_encoder.transform(stringIndexed_df)\neducation_onehot_df = education_encoder.transform(workclass_onehot_df)\nmarital_status_onehot_df = marital_status_encoder.transform(education_onehot_df)\noccupation_onehot_df = occupation_encoder.transform(marital_status_onehot_df)\nrelationship_onehot_df = relationship_encoder.transform(occupation_onehot_df)\nrace_onehot_df = race_encoder.transform(relationship_onehot_df)\nsex_onehot_df = sex_encoder.transform(race_onehot_df)\nonehot_df = native_country_encoder.transform(sex_onehot_df)\n\nz.show(onehot_df.limit(3))","user":"anonymous","dateUpdated":"2019-04-26T09:11:36+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"workclass\teducation\teducation_merged\tmarital_status\toccupation\trelationship\trace\tsex\tnative_country\tage\tfnlwgt\teducation_num\tcapital_gain\tcapital_loss\thours_per_week\toutput\tworkclass_indexed\teducation_indexed\tmarital_status_indexed\toccupation_indexed\trelationship_indexed\trace_indexed\tsex_indexed\tnative_country_indexed\tworkclass_onehot\teducation_onehot\tmarital_status_onehot\toccupation_onehot\trelationship_onehot\trace_onehot\tsex_onehot\tnative_country_onehot\nState-gov\tBachelors\tUnder-Graduate\tNever-married\tAdm-clerical\tNot-in-family\tWhite\tMale\tUnited-States\t39\t77516.0\t13.0\t2174.0\t0.0\t40.0\t<=50K\t3.0\t2.0\t1.0\t3.0\t1.0\t0.0\t0.0\t0.0\t(6,[3],[1.0])\t(15,[2],[1.0])\t(6,[1],[1.0])\t(12,[3],[1.0])\t(5,[1],[1.0])\t(4,[0],[1.0])\t(1,[0],[1.0])\t(39,[0],[1.0])\nSelf-emp-not-inc\tBachelors\tUnder-Graduate\tMarried-civ-spouse\tExec-managerial\tHusband\tWhite\tMale\tUnited-States\t50\t83311.0\t13.0\t0.0\t0.0\t13.0\t<=50K\t1.0\t2.0\t0.0\t2.0\t0.0\t0.0\t0.0\t0.0\t(6,[1],[1.0])\t(15,[2],[1.0])\t(6,[0],[1.0])\t(12,[2],[1.0])\t(5,[0],[1.0])\t(4,[0],[1.0])\t(1,[0],[1.0])\t(39,[0],[1.0])\nPrivate\tHS-grad\tHS-grad\tDivorced\tHandlers-cleaners\tNot-in-family\tWhite\tMale\tUnited-States\t38\t215646.0\t9.0\t0.0\t0.0\t40.0\t<=50K\t0.0\t0.0\t2.0\t8.0\t1.0\t0.0\t0.0\t0.0\t(6,[0],[1.0])\t(15,[0],[1.0])\t(6,[2],[1.0])\t(12,[8],[1.0])\t(5,[1],[1.0])\t(4,[0],[1.0])\t(1,[0],[1.0])\t(39,[0],[1.0])\n"}]},"apps":[],"jobName":"paragraph_1556269534620_-939842884","id":"20190426-090534_2026595109","dateCreated":"2019-04-26T09:05:34+0000","dateStarted":"2019-04-26T09:11:36+0000","dateFinished":"2019-04-26T09:11:38+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:30631"},{"text":"%pyspark\noutput_indexer = StringIndexer(inputCol=\"output\", outputCol=\"label\", handleInvalid=\"skip\")\nlabel_df = output_indexer.fit(onehot_df).transform(onehot_df)\n\nz.show(label_df.limit(3))","user":"anonymous","dateUpdated":"2019-04-26T10:04:53+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"workclass\teducation\teducation_merged\tmarital_status\toccupation\trelationship\trace\tsex\tnative_country\tage\tfnlwgt\teducation_num\tcapital_gain\tcapital_loss\thours_per_week\toutput\tworkclass_indexed\teducation_indexed\tmarital_status_indexed\toccupation_indexed\trelationship_indexed\trace_indexed\tsex_indexed\tnative_country_indexed\tworkclass_onehot\teducation_onehot\tmarital_status_onehot\toccupation_onehot\trelationship_onehot\trace_onehot\tsex_onehot\tnative_country_onehot\tlabel\nState-gov\tBachelors\tUnder-Graduate\tNever-married\tAdm-clerical\tNot-in-family\tWhite\tMale\tUnited-States\t39\t77516.0\t13.0\t2174.0\t0.0\t40.0\t<=50K\t3.0\t2.0\t1.0\t3.0\t1.0\t0.0\t0.0\t0.0\t(6,[3],[1.0])\t(15,[2],[1.0])\t(6,[1],[1.0])\t(12,[3],[1.0])\t(5,[1],[1.0])\t(4,[0],[1.0])\t(1,[0],[1.0])\t(39,[0],[1.0])\t0.0\nSelf-emp-not-inc\tBachelors\tUnder-Graduate\tMarried-civ-spouse\tExec-managerial\tHusband\tWhite\tMale\tUnited-States\t50\t83311.0\t13.0\t0.0\t0.0\t13.0\t<=50K\t1.0\t2.0\t0.0\t2.0\t0.0\t0.0\t0.0\t0.0\t(6,[1],[1.0])\t(15,[2],[1.0])\t(6,[0],[1.0])\t(12,[2],[1.0])\t(5,[0],[1.0])\t(4,[0],[1.0])\t(1,[0],[1.0])\t(39,[0],[1.0])\t0.0\nPrivate\tHS-grad\tHS-grad\tDivorced\tHandlers-cleaners\tNot-in-family\tWhite\tMale\tUnited-States\t38\t215646.0\t9.0\t0.0\t0.0\t40.0\t<=50K\t0.0\t0.0\t2.0\t8.0\t1.0\t0.0\t0.0\t0.0\t(6,[0],[1.0])\t(15,[0],[1.0])\t(6,[2],[1.0])\t(12,[8],[1.0])\t(5,[1],[1.0])\t(4,[0],[1.0])\t(1,[0],[1.0])\t(39,[0],[1.0])\t0.0\n"}]},"apps":[],"jobName":"paragraph_1556270093927_-1224359500","id":"20190426-091453_739876732","dateCreated":"2019-04-26T09:14:53+0000","dateStarted":"2019-04-26T10:04:54+0000","dateFinished":"2019-04-26T10:04:55+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:30632"},{"text":"%pyspark\nlabel_df.columns","user":"anonymous","dateUpdated":"2019-04-26T10:09:26+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"['workclass', 'education', 'education_merged', 'marital_status', 'occupation', 'relationship', 'race', 'sex', 'native_country', 'age', 'fnlwgt', 'education_num', 'capital_gain', 'capital_loss', 'hours_per_week', 'output', 'workclass_indexed', 'education_indexed', 'marital_status_indexed', 'occupation_indexed', 'relationship_indexed', 'race_indexed', 'sex_indexed', 'native_country_indexed', 'workclass_onehot', 'education_onehot', 'marital_status_onehot', 'occupation_onehot', 'relationship_onehot', 'race_onehot', 'sex_onehot', 'native_country_onehot', 'label']\n"}]},"apps":[],"jobName":"paragraph_1556273352643_-194395146","id":"20190426-100912_1080354401","dateCreated":"2019-04-26T10:09:12+0000","dateStarted":"2019-04-26T10:09:26+0000","dateFinished":"2019-04-26T10:09:26+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:30633"},{"text":"%pyspark\n# 'age', 'fnlwgt', 'education_num', 'capital_gain', 'capital_loss', 'hours_per_week'\nfrom pyspark.ml.feature import VectorAssembler\nassembler = VectorAssembler(inputCols=['workclass_onehot', 'education_onehot', 'marital_status_onehot', 'occupation_onehot', 'relationship_onehot', 'race_onehot', 'sex_onehot', 'native_country_onehot', 'age', 'fnlwgt', 'education_num', 'capital_gain', 'capital_loss', 'hours_per_week'], outputCol=\"features\")\nassembler_df = assembler.transform(label_df)\n\nz.show(assembler_df.limit(3))","user":"anonymous","dateUpdated":"2019-04-26T10:13:04+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"workclass\teducation\teducation_merged\tmarital_status\toccupation\trelationship\trace\tsex\tnative_country\tage\tfnlwgt\teducation_num\tcapital_gain\tcapital_loss\thours_per_week\toutput\tworkclass_indexed\teducation_indexed\tmarital_status_indexed\toccupation_indexed\trelationship_indexed\trace_indexed\tsex_indexed\tnative_country_indexed\tworkclass_onehot\teducation_onehot\tmarital_status_onehot\toccupation_onehot\trelationship_onehot\trace_onehot\tsex_onehot\tnative_country_onehot\tlabel\tfeatures\nState-gov\tBachelors\tUnder-Graduate\tNever-married\tAdm-clerical\tNot-in-family\tWhite\tMale\tUnited-States\t39\t77516.0\t13.0\t2174.0\t0.0\t40.0\t<=50K\t3.0\t2.0\t1.0\t3.0\t1.0\t0.0\t0.0\t0.0\t(6,[3],[1.0])\t(15,[2],[1.0])\t(6,[1],[1.0])\t(12,[3],[1.0])\t(5,[1],[1.0])\t(4,[0],[1.0])\t(1,[0],[1.0])\t(39,[0],[1.0])\t0.0\t(94,[3,8,22,30,40,44,48,49,88,89,90,91,93],[1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,39.0,77516.0,13.0,2174.0,40.0])\nSelf-emp-not-inc\tBachelors\tUnder-Graduate\tMarried-civ-spouse\tExec-managerial\tHusband\tWhite\tMale\tUnited-States\t50\t83311.0\t13.0\t0.0\t0.0\t13.0\t<=50K\t1.0\t2.0\t0.0\t2.0\t0.0\t0.0\t0.0\t0.0\t(6,[1],[1.0])\t(15,[2],[1.0])\t(6,[0],[1.0])\t(12,[2],[1.0])\t(5,[0],[1.0])\t(4,[0],[1.0])\t(1,[0],[1.0])\t(39,[0],[1.0])\t0.0\t(94,[1,8,21,29,39,44,48,49,88,89,90,93],[1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,50.0,83311.0,13.0,13.0])\nPrivate\tHS-grad\tHS-grad\tDivorced\tHandlers-cleaners\tNot-in-family\tWhite\tMale\tUnited-States\t38\t215646.0\t9.0\t0.0\t0.0\t40.0\t<=50K\t0.0\t0.0\t2.0\t8.0\t1.0\t0.0\t0.0\t0.0\t(6,[0],[1.0])\t(15,[0],[1.0])\t(6,[2],[1.0])\t(12,[8],[1.0])\t(5,[1],[1.0])\t(4,[0],[1.0])\t(1,[0],[1.0])\t(39,[0],[1.0])\t0.0\t(94,[0,6,23,35,40,44,48,49,88,89,90,93],[1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,38.0,215646.0,9.0,40.0])\n"}]},"apps":[],"jobName":"paragraph_1556272910241_438656356","id":"20190426-100150_880159260","dateCreated":"2019-04-26T10:01:50+0000","dateStarted":"2019-04-26T10:13:04+0000","dateFinished":"2019-04-26T10:13:05+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:30634"},{"text":"%pyspark\nfrom pyspark.ml.feature import StandardScaler","user":"anonymous","dateUpdated":"2019-04-26T10:15:39+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1556272909096_780698129","id":"20190426-100149_264612134","dateCreated":"2019-04-26T10:01:49+0000","dateStarted":"2019-04-26T10:15:39+0000","dateFinished":"2019-04-26T10:15:39+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:30635"},{"text":"%pyspark\nscaler = StandardScaler(inputCol=\"features\", outputCol=\"scaled_features\")\nscaler_df = scaler.fit(assembler_df).transform(assembler_df)\n\nz.show(scaler_df.limit(3))","user":"anonymous","dateUpdated":"2019-04-26T10:17:22+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"workclass\teducation\teducation_merged\tmarital_status\toccupation\trelationship\trace\tsex\tnative_country\tage\tfnlwgt\teducation_num\tcapital_gain\tcapital_loss\thours_per_week\toutput\tworkclass_indexed\teducation_indexed\tmarital_status_indexed\toccupation_indexed\trelationship_indexed\trace_indexed\tsex_indexed\tnative_country_indexed\tworkclass_onehot\teducation_onehot\tmarital_status_onehot\toccupation_onehot\trelationship_onehot\trace_onehot\tsex_onehot\tnative_country_onehot\tlabel\tfeatures\tscaled_features\nState-gov\tBachelors\tUnder-Graduate\tNever-married\tAdm-clerical\tNot-in-family\tWhite\tMale\tUnited-States\t39\t77516.0\t13.0\t2174.0\t0.0\t40.0\t<=50K\t3.0\t2.0\t1.0\t3.0\t1.0\t0.0\t0.0\t0.0\t(6,[3],[1.0])\t(15,[2],[1.0])\t(6,[1],[1.0])\t(12,[3],[1.0])\t(5,[1],[1.0])\t(4,[0],[1.0])\t(1,[0],[1.0])\t(39,[0],[1.0])\t0.0\t(94,[3,8,22,30,40,44,48,49,88,89,90,91,93],[1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,39.0,77516.0,13.0,2174.0,40.0])\t(94,[3,8,22,30,40,44,48,49,88,89,90,91,93],[4.926984421608854,2.678356374843646,2.138945468917177,3.0495188603896026,2.2833707070858567,2.8842073159551096,2.1349534581741607,3.5497727106407595,2.950421541964271,0.7337346424147729,5.0920722767732975,0.28957347319637977,3.3311359358256927])\nSelf-emp-not-inc\tBachelors\tUnder-Graduate\tMarried-civ-spouse\tExec-managerial\tHusband\tWhite\tMale\tUnited-States\t50\t83311.0\t13.0\t0.0\t0.0\t13.0\t<=50K\t1.0\t2.0\t0.0\t2.0\t0.0\t0.0\t0.0\t0.0\t(6,[1],[1.0])\t(15,[2],[1.0])\t(6,[0],[1.0])\t(12,[2],[1.0])\t(5,[0],[1.0])\t(4,[0],[1.0])\t(1,[0],[1.0])\t(39,[0],[1.0])\t0.0\t(94,[1,8,21,29,39,44,48,49,88,89,90,93],[1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,50.0,83311.0,13.0,13.0])\t(94,[1,8,21,29,39,44,48,49,88,89,90,93],[3.6056197442060847,2.678356374843646,2.004724332188047,2.9507654365061002,2.0311120498508806,2.8842073159551096,2.1349534581741607,3.5497727106407595,3.782591720467014,0.7885877340706068,5.0920722767732975,1.0826191791433502])\nPrivate\tHS-grad\tHS-grad\tDivorced\tHandlers-cleaners\tNot-in-family\tWhite\tMale\tUnited-States\t38\t215646.0\t9.0\t0.0\t0.0\t40.0\t<=50K\t0.0\t0.0\t2.0\t8.0\t1.0\t0.0\t0.0\t0.0\t(6,[0],[1.0])\t(15,[0],[1.0])\t(6,[2],[1.0])\t(12,[8],[1.0])\t(5,[1],[1.0])\t(4,[0],[1.0])\t(1,[0],[1.0])\t(39,[0],[1.0])\t0.0\t(94,[0,6,23,35,40,44,48,49,88,89,90,93],[1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,38.0,215646.0,9.0,40.0])\t(94,[0,6,23,35,40,44,48,49,88,89,90,93],[2.2706380838018303,2.13181352367185,2.8880414502182474,4.810634043094,2.2833707070858567,2.8842073159551096,2.1349534581741607,3.5497727106407595,2.8747697075549308,2.0412165320472693,3.5252808069968986,3.3311359358256927])\n"}]},"apps":[],"jobName":"paragraph_1556273739315_1152148262","id":"20190426-101539_766109072","dateCreated":"2019-04-26T10:15:39+0000","dateStarted":"2019-04-26T10:17:22+0000","dateFinished":"2019-04-26T10:17:25+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:30636"},{"text":"%pyspark\n# Veriyi eğitim ve test olarak bölme\ntrain_df, test_df = scaler_df.randomSplit([0.8, 0.2], seed=142)","user":"anonymous","dateUpdated":"2019-04-26T10:26:45+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1556274204532_2134134724","id":"20190426-102324_861256725","dateCreated":"2019-04-26T10:23:24+0000","dateStarted":"2019-04-26T10:25:12+0000","dateFinished":"2019-04-26T10:25:12+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:30637"},{"text":"%pyspark\nfrom pyspark.ml.classification import LogisticRegression","user":"anonymous","dateUpdated":"2019-04-26T10:19:50+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1556273802197_336388649","id":"20190426-101642_1482815238","dateCreated":"2019-04-26T10:16:42+0000","dateStarted":"2019-04-26T10:19:50+0000","dateFinished":"2019-04-26T10:19:51+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:30638"},{"text":"%pyspark\nlogreg_obj = LogisticRegression(featuresCol=\"scaled_features\", labelCol=\"label\")\n\nlogreg_model = logreg_obj.fit(train_df)","user":"anonymous","dateUpdated":"2019-04-26T10:33:08+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1556273800786_-990610308","id":"20190426-101640_253872821","dateCreated":"2019-04-26T10:16:40+0000","dateStarted":"2019-04-26T10:27:30+0000","dateFinished":"2019-04-26T10:27:49+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:30639"},{"text":"%pyspark\ntest_result_df = logreg_model.transform(test_df)\n\nz.show(test_result_df.select(\"label\",\"prediction\",\"probability\").limit(10))","user":"anonymous","dateUpdated":"2019-04-26T10:29:27+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"label\tprediction\tprobability\n0.0\t0.0\t[0.9889950425874078,0.01100495741259216]\n0.0\t0.0\t[0.7373498028783323,0.2626501971216677]\n0.0\t0.0\t[0.9420051529879119,0.05799484701208819]\n0.0\t0.0\t[0.9779068490609822,0.022093150939017706]\n0.0\t0.0\t[0.9789856671638536,0.021014332836146277]\n0.0\t0.0\t[0.8948438662466567,0.10515613375334332]\n0.0\t0.0\t[0.7356722309402693,0.2643277690597307]\n0.0\t0.0\t[0.9952916377949619,0.004708362205038094]\n0.0\t0.0\t[0.9988109504953044,0.0011890495046956479]\n0.0\t0.0\t[0.9966845502479874,0.0033154497520125528]\n"}]},"apps":[],"jobName":"paragraph_1556273995780_-1903944544","id":"20190426-101955_214390745","dateCreated":"2019-04-26T10:19:55+0000","dateStarted":"2019-04-26T10:29:27+0000","dateFinished":"2019-04-26T10:29:34+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:30640"},{"text":"%pyspark\nfrom pyspark.ml.evaluation import BinaryClassificationEvaluator","user":"anonymous","dateUpdated":"2019-04-26T10:30:57+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1556273994741_-763564128","id":"20190426-101954_1744634808","dateCreated":"2019-04-26T10:19:54+0000","dateStarted":"2019-04-26T10:30:57+0000","dateFinished":"2019-04-26T10:30:57+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:30641"},{"text":"%pyspark\nevaluator = BinaryClassificationEvaluator(rawPredictionCol=\"rawPrediction\", metricName=\"areaUnderROC\")\nevaluator.evaluate(test_result_df)","user":"anonymous","dateUpdated":"2019-04-26T10:39:01+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"0.9041753237363921\n"}]},"apps":[],"jobName":"paragraph_1556274657207_1975457834","id":"20190426-103057_1277352167","dateCreated":"2019-04-26T10:30:57+0000","dateStarted":"2019-04-26T10:39:01+0000","dateFinished":"2019-04-26T10:39:09+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:30642"},{"text":"%pyspark\ntest_result_df.select(\"label\",\"prediction\").show()","user":"anonymous","dateUpdated":"2019-04-26T10:39:52+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-----+----------+\n|label|prediction|\n+-----+----------+\n|  0.0|       0.0|\n|  0.0|       0.0|\n|  0.0|       0.0|\n|  0.0|       0.0|\n|  0.0|       0.0|\n|  0.0|       0.0|\n|  0.0|       0.0|\n|  0.0|       0.0|\n|  0.0|       0.0|\n|  0.0|       0.0|\n|  0.0|       0.0|\n|  0.0|       0.0|\n|  0.0|       0.0|\n|  0.0|       0.0|\n|  0.0|       0.0|\n|  0.0|       0.0|\n|  0.0|       0.0|\n|  0.0|       0.0|\n|  1.0|       1.0|\n|  1.0|       1.0|\n+-----+----------+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1556275141412_1825295205","id":"20190426-103901_938768731","dateCreated":"2019-04-26T10:39:01+0000","dateStarted":"2019-04-26T10:39:53+0000","dateFinished":"2019-04-26T10:39:59+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:30643"},{"text":"%pyspark\n# accuracy hesaplama\ntp = test_result_df.select(\"label\",\"prediction\").where((test_result_df.label == 1) & (test_result_df.prediction ==1)).count()\n\ntn = test_result_df.select(\"label\",\"prediction\").where((test_result_df.label == 0) & (test_result_df.prediction ==0)).count()\n\nfp = test_result_df.select(\"label\",\"prediction\").where((test_result_df.label == 0) & (test_result_df.prediction ==1)).count()\n\nfn = test_result_df.select(\"label\",\"prediction\").where((test_result_df.label == 1) & (test_result_df.prediction ==0)).count()\n\ntotal = test_result_df.count()\n\nprint(\"tp: \", tp)\nprint(\"tn: \", tn)\nprint(\"fp: \", fp)\nprint(\"tp: \", tp)\nprint(\"fn: \", fn)\nprint(\"toplam: \", total)","user":"anonymous","dateUpdated":"2019-04-26T11:00:02+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"tp:  1369\ntn:  6275\nfp:  474\ntp:  1369\nfn:  955\ntoplam:  9073\n"}]},"apps":[],"jobName":"paragraph_1556275192741_-1077943374","id":"20190426-103952_1121832729","dateCreated":"2019-04-26T10:39:52+0000","dateStarted":"2019-04-26T11:00:02+0000","dateFinished":"2019-04-26T11:00:37+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:30644"},{"text":"%pyspark\naccuracy = (tp+tn)/total\n\nprint(\"%\",accuracy*100)","user":"anonymous","dateUpdated":"2019-04-26T11:01:01+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":" 84.24997244571807\n"}]},"apps":[],"jobName":"paragraph_1556276146764_1478078721","id":"20190426-105546_2118680281","dateCreated":"2019-04-26T10:55:46+0000","dateStarted":"2019-04-26T11:01:02+0000","dateFinished":"2019-04-26T11:01:02+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:30645"},{"text":"%pyspark\n","user":"anonymous","dateUpdated":"2019-04-26T11:01:01+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1556276461985_785021714","id":"20190426-110101_1477442445","dateCreated":"2019-04-26T11:01:01+0000","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:30646"}],"name":"/hadoop-spark-for-datascientists/spark_ml_classification_adult","id":"2ECAK3FWK","angularObjects":{"2CHS8UYQQ:shared_process":[],"2C8A4SZ9T_livy2:shared_process":[],"2CK8A9MEG:shared_process":[],"2C4U48MY3_spark2:shared_process":[],"2CKAY1A8Y:shared_process":[],"2CKEKWY8Z:shared_process":[]},"config":{"looknfeel":"default","personalizedMode":"false"},"info":{}}