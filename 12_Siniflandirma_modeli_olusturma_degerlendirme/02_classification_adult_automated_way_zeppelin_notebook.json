{"paragraphs":[{"text":"%pyspark\n# Hive tablosunu okuyup dataframe oluşturma\ndf = spark.sql(\"select * from adult_preprocessed\")","user":"anonymous","dateUpdated":"2019-04-26T11:44:15+0000","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1556277630623_-1277209964","id":"20190425-200014_892861738","dateCreated":"2019-04-26T11:20:30+0000","dateStarted":"2019-04-26T11:44:16+0000","dateFinished":"2019-04-26T11:44:16+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:33459"},{"text":"%pyspark\nz.show(df.limit(5))","user":"anonymous","dateUpdated":"2019-04-26T11:24:13+0000","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python"}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"workclass\teducation\teducation_merged\tmarital_status\toccupation\trelationship\trace\tsex\tnative_country\tage\tfnlwgt\teducation_num\tcapital_gain\tcapital_loss\thours_per_week\toutput\nState-gov\tBachelors\tUnder-Graduate\tNever-married\tAdm-clerical\tNot-in-family\tWhite\tMale\tUnited-States\t39\t77516.0\t13.0\t2174.0\t0.0\t40.0\t<=50K\nSelf-emp-not-inc\tBachelors\tUnder-Graduate\tMarried-civ-spouse\tExec-managerial\tHusband\tWhite\tMale\tUnited-States\t50\t83311.0\t13.0\t0.0\t0.0\t13.0\t<=50K\nPrivate\tHS-grad\tHS-grad\tDivorced\tHandlers-cleaners\tNot-in-family\tWhite\tMale\tUnited-States\t38\t215646.0\t9.0\t0.0\t0.0\t40.0\t<=50K\nPrivate\t11th\tHigh-School\tMarried-civ-spouse\tHandlers-cleaners\tHusband\tBlack\tMale\tUnited-States\t53\t234721.0\t7.0\t0.0\t0.0\t40.0\t<=50K\nPrivate\tBachelors\tUnder-Graduate\tMarried-civ-spouse\tProf-specialty\tWife\tBlack\tFemale\tCuba\t28\t338409.0\t13.0\t0.0\t0.0\t40.0\t<=50K\n"}]},"apps":[],"jobName":"paragraph_1556277630624_-1291445674","id":"20190425-200201_1475409006","dateCreated":"2019-04-26T11:20:30+0000","dateStarted":"2019-04-26T11:24:13+0000","dateFinished":"2019-04-26T11:24:21+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:33460"},{"text":"%pyspark\nz.show(df.describe())","user":"anonymous","dateUpdated":"2019-04-26T11:24:19+0000","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python"}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"summary\tworkclass\teducation\teducation_merged\tmarital_status\toccupation\trelationship\trace\tsex\tnative_country\tage\tfnlwgt\teducation_num\tcapital_gain\tcapital_loss\thours_per_week\toutput\ncount\t45207\t45207\t45207\t45207\t45207\t45207\t45207\t45207\t45207\t45207\t45207\t45207\t45207\t45207\t45207\t45207\nmean\tnull\tnull\tnull\tnull\tnull\tnull\tnull\tnull\tnull\t38.55018028181476\t189729.29716636805\t10.11830026323357\t1101.6343707832857\t88.53429778574115\t40.93779724378968\tnull\nstddev\tnull\tnull\tnull\tnull\tnull\tnull\tnull\tnull\tnull\t13.218450124938885\t105645.82277986674\t2.552988114347374\t7507.593758512776\t404.8097839880829\t12.00791584930777\tnull\nmin\tFederal-gov\t10th\tAssoc-acdm\tDivorced\tAdm-clerical\tHusband\tAmer-Indian-Eskimo\tFemale\tCambodia\t17\t13492.0\t1.0\t0.0\t0.0\t1.0\t<=50K\nmax\tWithout-pay\tSome-college\tUnder-Graduate\tWidowed\tTransport-moving\tWife\tWhite\tMale\tYugoslavia\t90\t1490400.0\t16.0\t99999.0\t4356.0\t99.0\t>50K\n"}]},"apps":[],"jobName":"paragraph_1556277630625_-1291830423","id":"20190425-200621_1610568337","dateCreated":"2019-04-26T11:20:30+0000","dateStarted":"2019-04-26T11:24:19+0000","dateFinished":"2019-04-26T11:24:33+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:33461"},{"text":"%pyspark\n# hedef değişken output dağılımı, sınıf dengesi\nimport pyspark.sql.functions as f\ndf.groupBy(\"output\").agg(f.count(\"*\").alias(\"sayi\")).show()","user":"anonymous","dateUpdated":"2019-04-26T11:24:32+0000","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python"}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+------+-----+\n|output| sayi|\n+------+-----+\n| <=50K|34003|\n|  >50K|11204|\n+------+-----+\n\n"}]},"apps":[],"jobName":"paragraph_1556277630625_-1291830423","id":"20190426-080923_2091944499","dateCreated":"2019-04-26T11:20:30+0000","dateStarted":"2019-04-26T11:24:32+0000","dateFinished":"2019-04-26T11:24:41+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:33462"},{"text":"%pyspark\n# education dağılımı\ndf.groupBy(\"education\").agg(\nf.count(\"*\").alias(\"sayi\"), \nf.mean(\"hours_per_week\").alias(\"ortalama_calima_saati\")\n).sort(f.desc(\"sayi\")) \\\n.show()","user":"anonymous","dateUpdated":"2019-04-26T11:24:44+0000","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python"}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+------------+-----+---------------------+\n|   education| sayi|ortalama_calima_saati|\n+------------+-----+---------------------+\n|     HS-grad|14778|    41.10211124644742|\n|Some-college| 9894|    39.47321609055994|\n|   Bachelors| 7569|   42.832342449464925|\n|     Masters| 2512|     43.9781050955414|\n|   Assoc-voc| 1959|    42.00816743236345|\n|        11th| 1619|    34.34651019147622|\n|  Assoc-acdm| 1507|    41.52289316522893|\n|        10th| 1223|    37.50695012264922|\n|     7th-8th|  823|    39.81166464155528|\n| Prof-school|  784|   47.923469387755105|\n|         9th|  676|    38.99556213017752|\n|        12th|  576|    35.57465277777778|\n|   Doctorate|  544|    47.29044117647059|\n|     5th-6th|  449|    38.83964365256125|\n|     1st-4th|  222|    39.18468468468468|\n|   Preschool|   72|   36.791666666666664|\n+------------+-----+---------------------+\n\n"}]},"apps":[],"jobName":"paragraph_1556277630625_-1291830423","id":"20190426-082559_2087232512","dateCreated":"2019-04-26T11:20:30+0000","dateStarted":"2019-04-26T11:24:44+0000","dateFinished":"2019-04-26T11:24:48+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:33463"},{"text":"%pyspark\ndf.columns","user":"anonymous","dateUpdated":"2019-04-26T11:24:52+0000","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python"}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"['workclass', 'education', 'education_merged', 'marital_status', 'occupation', 'relationship', 'race', 'sex', 'native_country', 'age', 'fnlwgt', 'education_num', 'capital_gain', 'capital_loss', 'hours_per_week', 'output']\n"}]},"apps":[],"jobName":"paragraph_1556277630625_-1291830423","id":"20190426-083604_1527464856","dateCreated":"2019-04-26T11:20:30+0000","dateStarted":"2019-04-26T11:24:52+0000","dateFinished":"2019-04-26T11:24:52+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:33464"},{"text":"%pyspark\nkategorik = ['workclass', 'education', 'education_merged', 'marital_status', 'occupation', 'relationship', 'race', 'sex', 'native_country']\nnumerik = ['age', 'fnlwgt', 'education_num', 'capital_gain', 'capital_loss', 'hours_per_week']\nlabel = [\"output\"]","user":"anonymous","dateUpdated":"2019-04-26T11:26:05+0000","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python"}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1556277630625_-1291830423","id":"20190426-083027_606068187","dateCreated":"2019-04-26T11:20:30+0000","dateStarted":"2019-04-26T11:26:05+0000","dateFinished":"2019-04-26T11:26:06+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:33465"},{"text":"%md\n## StringIndexer Aşaması","dateUpdated":"2019-04-26T11:20:30+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h2>StringIndexer Aşaması</h2>\n"}]},"apps":[],"jobName":"paragraph_1556277630626_-1290676176","id":"20190426-085754_1514608529","dateCreated":"2019-04-26T11:20:30+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:33466"},{"text":"%pyspark\nfrom pyspark.ml.feature import StringIndexer\ndf_cat = df\nfor column in kategorik:\n    indexer = StringIndexer(inputCol=column, outputCol=column+\"_indexed\", handleInvalid=\"skip\")\n    df_cat = indexer.fit(df_cat).transform(df_cat)\n\nz.show(df_cat.limit(5))","user":"anonymous","dateUpdated":"2019-04-26T11:45:00+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"workclass\teducation\teducation_merged\tmarital_status\toccupation\trelationship\trace\tsex\tnative_country\tage\tfnlwgt\teducation_num\tcapital_gain\tcapital_loss\thours_per_week\toutput\tworkclass_indexed\teducation_indexed\teducation_merged_indexed\tmarital_status_indexed\toccupation_indexed\trelationship_indexed\trace_indexed\tsex_indexed\tnative_country_indexed\nState-gov\tBachelors\tUnder-Graduate\tNever-married\tAdm-clerical\tNot-in-family\tWhite\tMale\tUnited-States\t39\t77516.0\t13.0\t2174.0\t0.0\t40.0\t<=50K\t3.0\t2.0\t0.0\t1.0\t3.0\t1.0\t0.0\t0.0\t0.0\nSelf-emp-not-inc\tBachelors\tUnder-Graduate\tMarried-civ-spouse\tExec-managerial\tHusband\tWhite\tMale\tUnited-States\t50\t83311.0\t13.0\t0.0\t0.0\t13.0\t<=50K\t1.0\t2.0\t0.0\t0.0\t2.0\t0.0\t0.0\t0.0\t0.0\nPrivate\tHS-grad\tHS-grad\tDivorced\tHandlers-cleaners\tNot-in-family\tWhite\tMale\tUnited-States\t38\t215646.0\t9.0\t0.0\t0.0\t40.0\t<=50K\t0.0\t0.0\t1.0\t2.0\t8.0\t1.0\t0.0\t0.0\t0.0\nPrivate\t11th\tHigh-School\tMarried-civ-spouse\tHandlers-cleaners\tHusband\tBlack\tMale\tUnited-States\t53\t234721.0\t7.0\t0.0\t0.0\t40.0\t<=50K\t0.0\t5.0\t2.0\t0.0\t8.0\t0.0\t1.0\t0.0\t0.0\nPrivate\tBachelors\tUnder-Graduate\tMarried-civ-spouse\tProf-specialty\tWife\tBlack\tFemale\tCuba\t28\t338409.0\t13.0\t0.0\t0.0\t40.0\t<=50K\t0.0\t2.0\t0.0\t0.0\t1.0\t4.0\t1.0\t1.0\t8.0\n"}]},"apps":[],"jobName":"paragraph_1556277930903_2070534543","id":"20190426-112530_1033069687","dateCreated":"2019-04-26T11:25:30+0000","dateStarted":"2019-04-26T11:45:00+0000","dateFinished":"2019-04-26T11:45:07+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:33467"},{"text":"%md\n## OneHotEncoder Aşaması","dateUpdated":"2019-04-26T11:20:30+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h2>OneHotEncoder Aşaması</h2>\n"}]},"apps":[],"jobName":"paragraph_1556277630626_-1290676176","id":"20190426-084607_466447386","dateCreated":"2019-04-26T11:20:30+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:33468"},{"text":"%pyspark\nfrom pyspark.ml.feature import OneHotEncoder\ndf_onehot = df_cat\nvec_onehot =[]\nfor column in kategorik:\n    encoder = OneHotEncoder(inputCol=column+\"_indexed\", outputCol=column+\"_onehot\")\n    df_onehot = encoder.transform(df_onehot)\n    vec_onehot.append(column+\"_onehot\")\n\nz.show(df_onehot.limit(5))","user":"anonymous","dateUpdated":"2019-04-26T11:46:29+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"workclass\teducation\teducation_merged\tmarital_status\toccupation\trelationship\trace\tsex\tnative_country\tage\tfnlwgt\teducation_num\tcapital_gain\tcapital_loss\thours_per_week\toutput\tworkclass_indexed\teducation_indexed\teducation_merged_indexed\tmarital_status_indexed\toccupation_indexed\trelationship_indexed\trace_indexed\tsex_indexed\tnative_country_indexed\tworkclass_onehot\teducation_onehot\teducation_merged_onehot\tmarital_status_onehot\toccupation_onehot\trelationship_onehot\trace_onehot\tsex_onehot\tnative_country_onehot\nState-gov\tBachelors\tUnder-Graduate\tNever-married\tAdm-clerical\tNot-in-family\tWhite\tMale\tUnited-States\t39\t77516.0\t13.0\t2174.0\t0.0\t40.0\t<=50K\t3.0\t2.0\t0.0\t1.0\t3.0\t1.0\t0.0\t0.0\t0.0\t(6,[3],[1.0])\t(15,[2],[1.0])\t(8,[0],[1.0])\t(6,[1],[1.0])\t(12,[3],[1.0])\t(5,[1],[1.0])\t(4,[0],[1.0])\t(1,[0],[1.0])\t(39,[0],[1.0])\nSelf-emp-not-inc\tBachelors\tUnder-Graduate\tMarried-civ-spouse\tExec-managerial\tHusband\tWhite\tMale\tUnited-States\t50\t83311.0\t13.0\t0.0\t0.0\t13.0\t<=50K\t1.0\t2.0\t0.0\t0.0\t2.0\t0.0\t0.0\t0.0\t0.0\t(6,[1],[1.0])\t(15,[2],[1.0])\t(8,[0],[1.0])\t(6,[0],[1.0])\t(12,[2],[1.0])\t(5,[0],[1.0])\t(4,[0],[1.0])\t(1,[0],[1.0])\t(39,[0],[1.0])\nPrivate\tHS-grad\tHS-grad\tDivorced\tHandlers-cleaners\tNot-in-family\tWhite\tMale\tUnited-States\t38\t215646.0\t9.0\t0.0\t0.0\t40.0\t<=50K\t0.0\t0.0\t1.0\t2.0\t8.0\t1.0\t0.0\t0.0\t0.0\t(6,[0],[1.0])\t(15,[0],[1.0])\t(8,[1],[1.0])\t(6,[2],[1.0])\t(12,[8],[1.0])\t(5,[1],[1.0])\t(4,[0],[1.0])\t(1,[0],[1.0])\t(39,[0],[1.0])\nPrivate\t11th\tHigh-School\tMarried-civ-spouse\tHandlers-cleaners\tHusband\tBlack\tMale\tUnited-States\t53\t234721.0\t7.0\t0.0\t0.0\t40.0\t<=50K\t0.0\t5.0\t2.0\t0.0\t8.0\t0.0\t1.0\t0.0\t0.0\t(6,[0],[1.0])\t(15,[5],[1.0])\t(8,[2],[1.0])\t(6,[0],[1.0])\t(12,[8],[1.0])\t(5,[0],[1.0])\t(4,[1],[1.0])\t(1,[0],[1.0])\t(39,[0],[1.0])\nPrivate\tBachelors\tUnder-Graduate\tMarried-civ-spouse\tProf-specialty\tWife\tBlack\tFemale\tCuba\t28\t338409.0\t13.0\t0.0\t0.0\t40.0\t<=50K\t0.0\t2.0\t0.0\t0.0\t1.0\t4.0\t1.0\t1.0\t8.0\t(6,[0],[1.0])\t(15,[2],[1.0])\t(8,[0],[1.0])\t(6,[0],[1.0])\t(12,[1],[1.0])\t(5,[4],[1.0])\t(4,[1],[1.0])\t(1,[],[])\t(39,[8],[1.0])\n"}]},"apps":[],"jobName":"paragraph_1556278280098_-1403087441","id":"20190426-113120_1997058320","dateCreated":"2019-04-26T11:31:20+0000","dateStarted":"2019-04-26T11:46:29+0000","dateFinished":"2019-04-26T11:46:30+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:33469"},{"text":"%md\n## labelIndexer Aşaması\n","user":"anonymous","dateUpdated":"2019-04-26T11:50:18+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h2>labelIndexer Aşaması</h2>\n"}]},"apps":[],"jobName":"paragraph_1556279403418_1270401327","id":"20190426-115003_993446553","dateCreated":"2019-04-26T11:50:03+0000","dateStarted":"2019-04-26T11:50:18+0000","dateFinished":"2019-04-26T11:50:18+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:33470"},{"text":"%pyspark\nlabel_df = df_onehot\noutput_indexer = StringIndexer(inputCol=\"output\", outputCol=\"label\", handleInvalid=\"skip\")\nlabel_df = output_indexer.fit(label_df).transform(label_df)","user":"anonymous","dateUpdated":"2019-04-26T11:47:23+0000","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python"}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1556277630627_-1291060925","id":"20190426-091453_739876732","dateCreated":"2019-04-26T11:20:30+0000","dateStarted":"2019-04-26T11:47:24+0000","dateFinished":"2019-04-26T11:47:24+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:33471"},{"text":"%pyspark\nz.show(label_df.limit(3))","user":"anonymous","dateUpdated":"2019-04-26T11:47:27+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"workclass\teducation\teducation_merged\tmarital_status\toccupation\trelationship\trace\tsex\tnative_country\tage\tfnlwgt\teducation_num\tcapital_gain\tcapital_loss\thours_per_week\toutput\tworkclass_indexed\teducation_indexed\teducation_merged_indexed\tmarital_status_indexed\toccupation_indexed\trelationship_indexed\trace_indexed\tsex_indexed\tnative_country_indexed\tworkclass_onehot\teducation_onehot\teducation_merged_onehot\tmarital_status_onehot\toccupation_onehot\trelationship_onehot\trace_onehot\tsex_onehot\tnative_country_onehot\tlabel\nState-gov\tBachelors\tUnder-Graduate\tNever-married\tAdm-clerical\tNot-in-family\tWhite\tMale\tUnited-States\t39\t77516.0\t13.0\t2174.0\t0.0\t40.0\t<=50K\t3.0\t2.0\t0.0\t1.0\t3.0\t1.0\t0.0\t0.0\t0.0\t(6,[3],[1.0])\t(15,[2],[1.0])\t(8,[0],[1.0])\t(6,[1],[1.0])\t(12,[3],[1.0])\t(5,[1],[1.0])\t(4,[0],[1.0])\t(1,[0],[1.0])\t(39,[0],[1.0])\t0.0\nSelf-emp-not-inc\tBachelors\tUnder-Graduate\tMarried-civ-spouse\tExec-managerial\tHusband\tWhite\tMale\tUnited-States\t50\t83311.0\t13.0\t0.0\t0.0\t13.0\t<=50K\t1.0\t2.0\t0.0\t0.0\t2.0\t0.0\t0.0\t0.0\t0.0\t(6,[1],[1.0])\t(15,[2],[1.0])\t(8,[0],[1.0])\t(6,[0],[1.0])\t(12,[2],[1.0])\t(5,[0],[1.0])\t(4,[0],[1.0])\t(1,[0],[1.0])\t(39,[0],[1.0])\t0.0\nPrivate\tHS-grad\tHS-grad\tDivorced\tHandlers-cleaners\tNot-in-family\tWhite\tMale\tUnited-States\t38\t215646.0\t9.0\t0.0\t0.0\t40.0\t<=50K\t0.0\t0.0\t1.0\t2.0\t8.0\t1.0\t0.0\t0.0\t0.0\t(6,[0],[1.0])\t(15,[0],[1.0])\t(8,[1],[1.0])\t(6,[2],[1.0])\t(12,[8],[1.0])\t(5,[1],[1.0])\t(4,[0],[1.0])\t(1,[0],[1.0])\t(39,[0],[1.0])\t0.0\n"}]},"apps":[],"jobName":"paragraph_1556278904332_-289675553","id":"20190426-114144_1164377045","dateCreated":"2019-04-26T11:41:44+0000","dateStarted":"2019-04-26T11:47:27+0000","dateFinished":"2019-04-26T11:47:27+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:33472"},{"text":"%md\n## VectorAssembler Aşaması\n","user":"anonymous","dateUpdated":"2019-04-26T11:50:37+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h2>VectorAssembler Aşaması</h2>\n"}]},"apps":[],"jobName":"paragraph_1556279424752_310468145","id":"20190426-115024_906351708","dateCreated":"2019-04-26T11:50:24+0000","dateStarted":"2019-04-26T11:50:37+0000","dateFinished":"2019-04-26T11:50:37+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:33473"},{"text":"%pyspark\nfrom pyspark.ml.feature import VectorAssembler\nassembler_df = label_df\nassembler = VectorAssembler(inputCols=vec_onehot+numerik, outputCol=\"features\")\nassembler_df = assembler.transform(assembler_df)","user":"anonymous","dateUpdated":"2019-04-26T11:53:24+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1556279279388_3591765","id":"20190426-114759_1655332708","dateCreated":"2019-04-26T11:47:59+0000","dateStarted":"2019-04-26T11:53:24+0000","dateFinished":"2019-04-26T11:53:24+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:33474"},{"text":"%pyspark\nz.show(assembler_df.limit(5))","user":"anonymous","dateUpdated":"2019-04-26T11:53:28+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"workclass\teducation\teducation_merged\tmarital_status\toccupation\trelationship\trace\tsex\tnative_country\tage\tfnlwgt\teducation_num\tcapital_gain\tcapital_loss\thours_per_week\toutput\tworkclass_indexed\teducation_indexed\teducation_merged_indexed\tmarital_status_indexed\toccupation_indexed\trelationship_indexed\trace_indexed\tsex_indexed\tnative_country_indexed\tworkclass_onehot\teducation_onehot\teducation_merged_onehot\tmarital_status_onehot\toccupation_onehot\trelationship_onehot\trace_onehot\tsex_onehot\tnative_country_onehot\tlabel\tfeatures\nState-gov\tBachelors\tUnder-Graduate\tNever-married\tAdm-clerical\tNot-in-family\tWhite\tMale\tUnited-States\t39\t77516.0\t13.0\t2174.0\t0.0\t40.0\t<=50K\t3.0\t2.0\t0.0\t1.0\t3.0\t1.0\t0.0\t0.0\t0.0\t(6,[3],[1.0])\t(15,[2],[1.0])\t(8,[0],[1.0])\t(6,[1],[1.0])\t(12,[3],[1.0])\t(5,[1],[1.0])\t(4,[0],[1.0])\t(1,[0],[1.0])\t(39,[0],[1.0])\t0.0\t(102,[3,8,21,30,38,48,52,56,57,96,97,98,99,101],[1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,39.0,77516.0,13.0,2174.0,40.0])\nSelf-emp-not-inc\tBachelors\tUnder-Graduate\tMarried-civ-spouse\tExec-managerial\tHusband\tWhite\tMale\tUnited-States\t50\t83311.0\t13.0\t0.0\t0.0\t13.0\t<=50K\t1.0\t2.0\t0.0\t0.0\t2.0\t0.0\t0.0\t0.0\t0.0\t(6,[1],[1.0])\t(15,[2],[1.0])\t(8,[0],[1.0])\t(6,[0],[1.0])\t(12,[2],[1.0])\t(5,[0],[1.0])\t(4,[0],[1.0])\t(1,[0],[1.0])\t(39,[0],[1.0])\t0.0\t(102,[1,8,21,29,37,47,52,56,57,96,97,98,101],[1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,50.0,83311.0,13.0,13.0])\nPrivate\tHS-grad\tHS-grad\tDivorced\tHandlers-cleaners\tNot-in-family\tWhite\tMale\tUnited-States\t38\t215646.0\t9.0\t0.0\t0.0\t40.0\t<=50K\t0.0\t0.0\t1.0\t2.0\t8.0\t1.0\t0.0\t0.0\t0.0\t(6,[0],[1.0])\t(15,[0],[1.0])\t(8,[1],[1.0])\t(6,[2],[1.0])\t(12,[8],[1.0])\t(5,[1],[1.0])\t(4,[0],[1.0])\t(1,[0],[1.0])\t(39,[0],[1.0])\t0.0\t(102,[0,6,22,31,43,48,52,56,57,96,97,98,101],[1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,38.0,215646.0,9.0,40.0])\nPrivate\t11th\tHigh-School\tMarried-civ-spouse\tHandlers-cleaners\tHusband\tBlack\tMale\tUnited-States\t53\t234721.0\t7.0\t0.0\t0.0\t40.0\t<=50K\t0.0\t5.0\t2.0\t0.0\t8.0\t0.0\t1.0\t0.0\t0.0\t(6,[0],[1.0])\t(15,[5],[1.0])\t(8,[2],[1.0])\t(6,[0],[1.0])\t(12,[8],[1.0])\t(5,[0],[1.0])\t(4,[1],[1.0])\t(1,[0],[1.0])\t(39,[0],[1.0])\t0.0\t(102,[0,11,23,29,43,47,53,56,57,96,97,98,101],[1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,53.0,234721.0,7.0,40.0])\nPrivate\tBachelors\tUnder-Graduate\tMarried-civ-spouse\tProf-specialty\tWife\tBlack\tFemale\tCuba\t28\t338409.0\t13.0\t0.0\t0.0\t40.0\t<=50K\t0.0\t2.0\t0.0\t0.0\t1.0\t4.0\t1.0\t1.0\t8.0\t(6,[0],[1.0])\t(15,[2],[1.0])\t(8,[0],[1.0])\t(6,[0],[1.0])\t(12,[1],[1.0])\t(5,[4],[1.0])\t(4,[1],[1.0])\t(1,[],[])\t(39,[8],[1.0])\t0.0\t(102,[0,8,21,29,36,51,53,65,96,97,98,101],[1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,28.0,338409.0,13.0,40.0])\n"}]},"apps":[],"jobName":"paragraph_1556279488939_605044596","id":"20190426-115128_1102601308","dateCreated":"2019-04-26T11:51:28+0000","dateStarted":"2019-04-26T11:53:28+0000","dateFinished":"2019-04-26T11:53:28+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:33475"},{"text":"%pyspark\nfrom pyspark.ml.feature import StandardScaler","user":"anonymous","dateUpdated":"2019-04-26T11:52:35+0000","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python"}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1556277630628_-1292984669","id":"20190426-100149_264612134","dateCreated":"2019-04-26T11:20:30+0000","dateStarted":"2019-04-26T11:52:36+0000","dateFinished":"2019-04-26T11:52:36+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:33476"},{"text":"%pyspark\nscaler = StandardScaler(inputCol=\"features\", outputCol=\"scaled_features\")\nscaler_df = scaler.fit(assembler_df).transform(assembler_df)\n\nz.show(scaler_df.limit(3))","user":"anonymous","dateUpdated":"2019-04-26T11:53:38+0000","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python"}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"workclass\teducation\teducation_merged\tmarital_status\toccupation\trelationship\trace\tsex\tnative_country\tage\tfnlwgt\teducation_num\tcapital_gain\tcapital_loss\thours_per_week\toutput\tworkclass_indexed\teducation_indexed\teducation_merged_indexed\tmarital_status_indexed\toccupation_indexed\trelationship_indexed\trace_indexed\tsex_indexed\tnative_country_indexed\tworkclass_onehot\teducation_onehot\teducation_merged_onehot\tmarital_status_onehot\toccupation_onehot\trelationship_onehot\trace_onehot\tsex_onehot\tnative_country_onehot\tlabel\tfeatures\tscaled_features\nState-gov\tBachelors\tUnder-Graduate\tNever-married\tAdm-clerical\tNot-in-family\tWhite\tMale\tUnited-States\t39\t77516.0\t13.0\t2174.0\t0.0\t40.0\t<=50K\t3.0\t2.0\t0.0\t1.0\t3.0\t1.0\t0.0\t0.0\t0.0\t(6,[3],[1.0])\t(15,[2],[1.0])\t(8,[0],[1.0])\t(6,[1],[1.0])\t(12,[3],[1.0])\t(5,[1],[1.0])\t(4,[0],[1.0])\t(1,[0],[1.0])\t(39,[0],[1.0])\t0.0\t(102,[3,8,21,30,38,48,52,56,57,96,97,98,99,101],[1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,39.0,77516.0,13.0,2174.0,40.0])\t(102,[3,8,21,30,38,48,52,56,57,96,97,98,99,101],[4.926984421608854,2.678356374843646,2.053794181978513,2.138945468917177,3.0495188603896026,2.2833707070858567,2.8842073159551096,2.1349534581741607,3.5497727106407595,2.950421541964271,0.7337346424147729,5.0920722767732975,0.28957347319637977,3.3311359358256927])\nSelf-emp-not-inc\tBachelors\tUnder-Graduate\tMarried-civ-spouse\tExec-managerial\tHusband\tWhite\tMale\tUnited-States\t50\t83311.0\t13.0\t0.0\t0.0\t13.0\t<=50K\t1.0\t2.0\t0.0\t0.0\t2.0\t0.0\t0.0\t0.0\t0.0\t(6,[1],[1.0])\t(15,[2],[1.0])\t(8,[0],[1.0])\t(6,[0],[1.0])\t(12,[2],[1.0])\t(5,[0],[1.0])\t(4,[0],[1.0])\t(1,[0],[1.0])\t(39,[0],[1.0])\t0.0\t(102,[1,8,21,29,37,47,52,56,57,96,97,98,101],[1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,50.0,83311.0,13.0,13.0])\t(102,[1,8,21,29,37,47,52,56,57,96,97,98,101],[3.6056197442060847,2.678356374843646,2.053794181978513,2.004724332188047,2.9507654365061002,2.0311120498508806,2.8842073159551096,2.1349534581741607,3.5497727106407595,3.782591720467014,0.7885877340706068,5.0920722767732975,1.0826191791433502])\nPrivate\tHS-grad\tHS-grad\tDivorced\tHandlers-cleaners\tNot-in-family\tWhite\tMale\tUnited-States\t38\t215646.0\t9.0\t0.0\t0.0\t40.0\t<=50K\t0.0\t0.0\t1.0\t2.0\t8.0\t1.0\t0.0\t0.0\t0.0\t(6,[0],[1.0])\t(15,[0],[1.0])\t(8,[1],[1.0])\t(6,[2],[1.0])\t(12,[8],[1.0])\t(5,[1],[1.0])\t(4,[0],[1.0])\t(1,[0],[1.0])\t(39,[0],[1.0])\t0.0\t(102,[0,6,22,31,43,48,52,56,57,96,97,98,101],[1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,38.0,215646.0,9.0,40.0])\t(102,[0,6,22,31,43,48,52,56,57,96,97,98,101],[2.2706380838018303,2.13181352367185,2.13181352367185,2.8880414502182474,4.810634043094,2.2833707070858567,2.8842073159551096,2.1349534581741607,3.5497727106407595,2.8747697075549308,2.0412165320472693,3.5252808069968986,3.3311359358256927])\n"}]},"apps":[],"jobName":"paragraph_1556277630628_-1292984669","id":"20190426-101539_766109072","dateCreated":"2019-04-26T11:20:30+0000","dateStarted":"2019-04-26T11:53:38+0000","dateFinished":"2019-04-26T11:53:41+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:33477"},{"text":"%pyspark\n# Veriyi eğitim ve test olarak bölme\ntrain_df, test_df = scaler_df.randomSplit([0.8, 0.2], seed=142)","user":"anonymous","dateUpdated":"2019-04-26T11:53:44+0000","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python"}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1556277630628_-1292984669","id":"20190426-102324_861256725","dateCreated":"2019-04-26T11:20:30+0000","dateStarted":"2019-04-26T11:53:44+0000","dateFinished":"2019-04-26T11:53:44+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:33478"},{"text":"%pyspark\nfrom pyspark.ml.classification import LogisticRegression","user":"anonymous","dateUpdated":"2019-04-26T11:53:47+0000","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python"}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1556277630628_-1292984669","id":"20190426-101642_1482815238","dateCreated":"2019-04-26T11:20:30+0000","dateStarted":"2019-04-26T11:53:47+0000","dateFinished":"2019-04-26T11:53:47+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:33479"},{"text":"%pyspark\nlogreg_obj = LogisticRegression(featuresCol=\"scaled_features\", labelCol=\"label\")\nlogreg_model = logreg_obj.fit(train_df)","user":"anonymous","dateUpdated":"2019-04-26T11:53:51+0000","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python"}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1556277630629_-1293369418","id":"20190426-101640_253872821","dateCreated":"2019-04-26T11:20:30+0000","dateStarted":"2019-04-26T11:53:52+0000","dateFinished":"2019-04-26T11:54:11+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:33480"},{"text":"%pyspark\ntest_result_df = logreg_model.transform(test_df)\n\nz.show(test_result_df.select(\"label\",\"prediction\",\"probability\").limit(10))","user":"anonymous","dateUpdated":"2019-04-26T11:54:15+0000","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python"}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"label\tprediction\tprobability\n0.0\t0.0\t[0.9886938957887109,0.011306104211289187]\n0.0\t0.0\t[0.7371395488567305,0.2628604511432695]\n0.0\t0.0\t[0.9427673693807942,0.05723263061920576]\n0.0\t0.0\t[0.978566709629704,0.02143329037029592]\n0.0\t0.0\t[0.9786435451266651,0.02135645487333489]\n0.0\t0.0\t[0.898763421655441,0.10123657834455901]\n0.0\t0.0\t[0.7287310166482466,0.2712689833517534]\n0.0\t0.0\t[0.9953219719055597,0.004678028094440346]\n0.0\t0.0\t[0.9987602097712968,0.0012397902287032468]\n0.0\t0.0\t[0.9968123837959192,0.0031876162040809356]\n"}]},"apps":[],"jobName":"paragraph_1556277630629_-1293369418","id":"20190426-101955_214390745","dateCreated":"2019-04-26T11:20:30+0000","dateStarted":"2019-04-26T11:54:15+0000","dateFinished":"2019-04-26T11:54:22+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:33481"},{"text":"%pyspark\nfrom pyspark.ml.evaluation import BinaryClassificationEvaluator","user":"anonymous","dateUpdated":"2019-04-26T11:54:26+0000","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python"}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1556277630629_-1293369418","id":"20190426-101954_1744634808","dateCreated":"2019-04-26T11:20:30+0000","dateStarted":"2019-04-26T11:54:26+0000","dateFinished":"2019-04-26T11:54:26+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:33482"},{"text":"%pyspark\nevaluator = BinaryClassificationEvaluator(rawPredictionCol=\"rawPrediction\", metricName=\"areaUnderROC\")\nevaluator.evaluate(test_result_df)","user":"anonymous","dateUpdated":"2019-04-26T11:54:29+0000","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python"}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"0.9041308854579333\n"}]},"apps":[],"jobName":"paragraph_1556277630632_-1294523665","id":"20190426-103057_1277352167","dateCreated":"2019-04-26T11:20:30+0000","dateStarted":"2019-04-26T11:54:30+0000","dateFinished":"2019-04-26T11:54:38+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:33483"},{"text":"%pyspark\ntest_result_df.select(\"label\",\"prediction\").show()","user":"anonymous","dateUpdated":"2019-04-26T11:54:50+0000","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python"}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-----+----------+\n|label|prediction|\n+-----+----------+\n|  0.0|       0.0|\n|  0.0|       0.0|\n|  0.0|       0.0|\n|  0.0|       0.0|\n|  0.0|       0.0|\n|  0.0|       0.0|\n|  0.0|       0.0|\n|  0.0|       0.0|\n|  0.0|       0.0|\n|  0.0|       0.0|\n|  0.0|       0.0|\n|  0.0|       0.0|\n|  0.0|       0.0|\n|  0.0|       0.0|\n|  0.0|       0.0|\n|  0.0|       0.0|\n|  0.0|       0.0|\n|  0.0|       0.0|\n|  1.0|       1.0|\n|  1.0|       1.0|\n+-----+----------+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1556277630633_-1294908414","id":"20190426-103901_938768731","dateCreated":"2019-04-26T11:20:30+0000","dateStarted":"2019-04-26T11:54:50+0000","dateFinished":"2019-04-26T11:54:57+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:33484"},{"text":"%pyspark\n# accuracy hesaplama\ntp = test_result_df.select(\"label\",\"prediction\").where((test_result_df.label == 1) & (test_result_df.prediction ==1)).count()\n\ntn = test_result_df.select(\"label\",\"prediction\").where((test_result_df.label == 0) & (test_result_df.prediction ==0)).count()\n\nfp = test_result_df.select(\"label\",\"prediction\").where((test_result_df.label == 0) & (test_result_df.prediction ==1)).count()\n\nfn = test_result_df.select(\"label\",\"prediction\").where((test_result_df.label == 1) & (test_result_df.prediction ==0)).count()\n\ntotal = test_result_df.count()\n\nprint(\"tp: \", tp)\nprint(\"tn: \", tn)\nprint(\"fp: \", fp)\nprint(\"tp: \", tp)\nprint(\"fn: \", fn)\nprint(\"toplam: \", total)","user":"anonymous","dateUpdated":"2019-04-26T11:55:02+0000","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python"}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"tp:  1369\ntn:  6275\nfp:  474\ntp:  1369\nfn:  955\ntoplam:  9073\n"}]},"apps":[],"jobName":"paragraph_1556277630633_-1294908414","id":"20190426-103952_1121832729","dateCreated":"2019-04-26T11:20:30+0000","dateStarted":"2019-04-26T11:55:02+0000","dateFinished":"2019-04-26T11:55:41+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:33485"},{"text":"%pyspark\naccuracy = (tp+tn)/total\n\nprint(\"%\",accuracy*100)","dateUpdated":"2019-04-26T11:20:30+0000","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python"}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":" 84.24997244571807\n"}]},"apps":[],"jobName":"paragraph_1556277630633_-1294908414","id":"20190426-105546_2118680281","dateCreated":"2019-04-26T11:20:30+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:33486"},{"text":"%pyspark\n","dateUpdated":"2019-04-26T11:20:30+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1556277630633_-1294908414","id":"20190426-110101_1477442445","dateCreated":"2019-04-26T11:20:30+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:33487"}],"name":"/hadoop-spark-for-datascientists/spark_ml_classification_adult_automated","id":"2E8DSBU4J","angularObjects":{"2CHS8UYQQ:shared_process":[],"2C8A4SZ9T_livy2:shared_process":[],"2CK8A9MEG:shared_process":[],"2C4U48MY3_spark2:shared_process":[],"2CKAY1A8Y:shared_process":[],"2CKEKWY8Z:shared_process":[]},"config":{"looknfeel":"default","personalizedMode":"false"},"info":{}}